<!doctype html>

<html lang="en">
<head>
  <meta charset="utf-8">

  <title>The HTML5 Herald</title>
  <meta name="description" content="The HTML5 Herald">
  <meta name="author" content="SitePoint">

  <link rel="stylesheet" href="css/styles.css?v=1.0">
  <script language="JavaScript" type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/jsrsasign/8.0.11/jsrsasign-all-min.js"></script>
</head>

<body>

<script>
	function get_shared_key(public_key, private_key) {
		var x = public_key.substr(2, 64);
		var y = public_key.substr(66, 64);
		KJUR.crypto.ECParameterDB.regist("my",256,"FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFEFFFFFC2F","0","7","FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFEBAAEDCE6AF48A03BBFD25E8CD0364141","1",x,y,[]);
		var ec = new KJUR.crypto.ECDSA({"curve": "my"});
		var sharedPoint = ec.ecparams.G.multiply(new BigInteger(private_key.toString(), 16));
		var x = sharedPoint.getX().toBigInteger().toString();
		var y = sharedPoint.getY().toBigInteger().toString();
		return x+y;
	}
	console.log(get_shared_key("042505ae8b7ecec1f94e1f8a82bd22e2475ae7004307f3169ed849e65bd5a663dadf0a639fd652bdb72e48a6b1f102effaa6ba1e85e801fddb14fd56562f0a18a7",
								"def39c38d9cda3474748d916188bc8cca406eec4fd8a80bc6084e91199b71ed4"));
	console.log(get_shared_key("0460d2c504e50d2c08727e88bf1b6e75b84ce8478d5f07ae96f5041fa909e9cb333847af277ecc9066476b75a81ebcd4c13f6adb5633dd77374c9dc25a8e126a6d",
								"6fa2598e8cec7f1663a6a2ebd91b5654119ebec2e3d76fc25f6ef2f5638f059c"));
</script>
</body>
</html>