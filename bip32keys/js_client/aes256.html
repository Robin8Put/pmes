<!doctype html>

<html lang="en">
<head>
  <meta charset="utf-8">

  <title>The HTML5 Herald</title>
  <meta name="description" content="The HTML5 Herald">
  <meta name="author" content="SitePoint">


</head>

<body>
	<script src="https://cdnjs.cloudflare.com/ajax/libs/crypto-js/3.1.9-1/crypto-js.min.js"></script>
	<script language="JavaScript" type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/jsrsasign/8.0.11/jsrsasign-all-min.js"></script>
<script>
function hexToAscii(str){
    hexString = str;
    strOut = '';
        for (x = 0; x < hexString.length; x += 2) {
            strOut += String.fromCharCode(parseInt(hexString.substr(x, 2), 16));
        }
    return strOut;    
}

function encryptContent(content, private_key) {
	var sha256 = new KJUR.crypto.MessageDigest({alg: "sha256", prov: "cryptojs"});
	sha256.updateHex(private_key);
	password = sha256.digest();
	var encrypted = CryptoJS.AES.encrypt(content, password);
	return encrypted.toString();
}
function decryptContent(encrypted, private_key) {
	var sha256 = new KJUR.crypto.MessageDigest({alg: "sha256", prov: "cryptojs"});
	sha256.updateHex(private_key);
	password = sha256.digest();
	var decrypted = CryptoJS.AES.decrypt(encrypted, password);
	return hexToAscii(decrypted.toString());
}


function encryptPassword(private_key, password) {
	var sha256 = new KJUR.crypto.MessageDigest({alg: "sha256", prov: "cryptojs"});
	sha256.updateHex(private_key);
	priv_hash = sha256.digest();
	var encrypted = CryptoJS.AES.encrypt(priv_hash, password);
	return encrypted.toString();
}
function decryptPassword(encrypted, password) {
	var decrypted = CryptoJS.AES.decrypt(encrypted, password);
	return hexToAscii(decrypted.toString());
}


var encrypted = encryptPassword('Test', 'Hello');
var decrypted = decryptPassword(encrypted, 'Hello');
console.log(encrypted);
console.log(decrypted);


</script>
</body>
</html>
